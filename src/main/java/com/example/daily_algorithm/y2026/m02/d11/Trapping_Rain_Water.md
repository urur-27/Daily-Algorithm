# ğŸ§© Trapping Rain Water

**ë‚œì´ë„:** Hard  
**í”Œë«í¼:** LeetCode  
**ìœ í˜•:** Stack, Monotonic Stack, Two Pointers  
**ë§í¬:** https://leetcode.com/problems/trapping-rain-water/

---

## ğŸ“ ë¬¸ì œ ì„¤ëª…

ë†’ì´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë°°ì—´ `height`ê°€ ì£¼ì–´ì§„ë‹¤.  
ê° ë§‰ëŒ€ì˜ ë„ˆë¹„ëŠ” 1ì´ë©°, ë¹„ê°€ ì˜¨ ë’¤ **ì–¼ë§ˆë‚˜ ë§ì€ ë¹—ë¬¼ì´ ê³ ì¼ ìˆ˜ ìˆëŠ”ì§€**ë¥¼ ê³„ì‚°í•´ ë°˜í™˜í•˜ë¼.

---

## ğŸ” ì˜ˆì‹œ

ì…ë ¥  
height = [0,1,0,2,1,0,1,3,2,1,2,1]

ì¶œë ¥  
6

ì„¤ëª…  
ê³¨ì§œê¸° í˜•íƒœë¡œ ë¬¼ì´ ê³ ì´ë©° ì´ 6ë§Œí¼ ê³ ì¸ë‹¤.

---

## ğŸ“‹ ì œì•½ ì¡°ê±´ (Constraints)

- `1 <= height.length <= 2 * 10^4`
- `0 <= height[i] <= 10^5`

---

## ğŸ’¡ ì ‘ê·¼ ë°©ì‹


ë¹—ë¬¼ì€ â€œì™¼ìª½ ë²½â€ê³¼ â€œì˜¤ë¥¸ìª½ ë²½â€ ì‚¬ì´ì— ê³ ì¸ë‹¤.  
ì¦‰, ì–´ë–¤ ìœ„ì¹˜ì˜ ë¬¼ ë†’ì´ëŠ”

- ì¢Œì¸¡ì—ì„œ ìì‹ ë³´ë‹¤ ë†’ì€ ë²½
- ìš°ì¸¡ì—ì„œ ìì‹ ë³´ë‹¤ ë†’ì€ ë²½

ì´ ë‘ ë²½ì´ ë§Œë“¤ì–´ì£¼ëŠ” ê·¸ë¦‡(ê³¨ì§œê¸°)ì— ì˜í•´ ê²°ì •ëœë‹¤.

ë‹¨ì¡° ìŠ¤íƒ í’€ì´ì—ì„œëŠ” ë°°ì—´ì„ ì™¼ìª½ë¶€í„° ë³´ë©´ì„œ,
**â€œì•„ì§ ì˜¤ë¥¸ìª½ ë²½ì„ ëª» ë§Œë‚œ ê³¨ì§œê¸° ë°”ë‹¥â€**ì„ ìŠ¤íƒì— ìŒ“ì•„ë‘ê³ ,
ì˜¤ë¥¸ìª½ ë²½ì„ ë§Œë‚˜ëŠ” ìˆœê°„(í˜„ì¬ ë†’ì´ê°€ ë” ì»¤ì§€ëŠ” ìˆœê°„) ë¬¼ì˜ ì–‘ì„ ê³„ì‚°í•œë‹¤.

---

### ìŠ¤íƒì— ì €ì¥í•˜ëŠ” ê²ƒ
- ì¸ë±ìŠ¤(index)
- ìŠ¤íƒì€ **ë†’ì´ ê¸°ì¤€ ë‹¨ì¡° ê°ì†Œ** í˜•íƒœë¥¼ ìœ ì§€í•œë‹¤.
    - (í˜„ì¬ ë†’ì´ê°€ ë” ì»¤ì§€ë©´) ê³¨ì§œê¸°ê°€ ë‹«íˆëŠ” ìˆœê°„ì´ë¯€ë¡œ popí•˜ë©° ê³„ì‚°í•œë‹¤.

---

### ë¬¼ ê³„ì‚°(í•µì‹¬)

í˜„ì¬ ì¸ë±ìŠ¤ë¥¼ `i`ë¼ê³  í•˜ê³ ,
ìŠ¤íƒì—ì„œ popëœ ì¸ë±ìŠ¤ë¥¼ `bottom`(ê³¨ì§œê¸° ë°”ë‹¥)ì´ë¼ê³  í•˜ì.

pop ì´í›„ ìŠ¤íƒì˜ topì´ `left`ê°€ ëœë‹¤ë©´:
- `left` = ì™¼ìª½ ë²½
- `i` = ì˜¤ë¥¸ìª½ ë²½
- `bottom` = ê·¸ ì‚¬ì´ ë°”ë‹¥

ì´ë•Œ ê³ ì´ëŠ” ë¬¼ì˜ ë†’ì´(ì„¸ë¡œ)ëŠ”:

    boundedHeight = min(height[left], height[i]) - height[bottom]

ê°€ë¡œ í­(ë„ˆë¹„)ì€:

    width = i - left - 1

ë”°ë¼ì„œ ì¶”ê°€ ë¬¼ì˜ ì–‘ì€:

    water = boundedHeight * width

---

## ì½”ë“œ

    class Solution {
        public int trap(int[] height) {
            Deque<Integer> stack = new ArrayDeque<>();
            int water = 0;

            for (int i = 0; i < height.length; i++) {
                while (!stack.isEmpty() && height[i] > height[stack.peek()]) {
                    int bottom = stack.pop();

                    if (stack.isEmpty()) break; // ì™¼ìª½ ë²½ì´ ì—†ìœ¼ë©´ ë¬¼ì„ ëª» ê³ ì„

                    int left = stack.peek();
                    int width = i - left - 1;

                    int boundedHeight = Math.min(height[left], height[i]) - height[bottom];
                    if (boundedHeight > 0) {
                        water += boundedHeight * width;
                    }
                }
                stack.push(i);
            }

            return water;
        }
    }

---

## â± ì‹œê°„ / ê³µê°„ ë³µì¡ë„

- ì‹œê°„ ë³µì¡ë„: `O(n)`  
  (ê° ì¸ë±ìŠ¤ëŠ” ìµœëŒ€ 1ë²ˆ push, 1ë²ˆ pop)
- ê³µê°„ ë³µì¡ë„: `O(n)`  
  (ìŠ¤íƒ)

---

## âœ¨ ì •ë¦¬

- ë‹¨ì¡° ìŠ¤íƒì€ â€œê³¨ì§œê¸° ë°”ë‹¥â€ì„ ê¸°ì–µí–ˆë‹¤ê°€,
  ì˜¤ë¥¸ìª½ ë²½ì„ ë§Œë‚˜ëŠ” ìˆœê°„ ë¬¼ì„ ê³„ì‚°í•œë‹¤.
- popë˜ëŠ” ìˆœê°„:
    - bottomì€ í™•ì •
    - pop í›„ ìŠ¤íƒ topì´ left ë²½
    - í˜„ì¬ iê°€ right ë²½
      â†’ ì´ ì„¸ ìš”ì†Œë¡œ ë¬¼ì˜ ë†’ì´ì™€ ë„ˆë¹„ë¥¼ ê³„ì‚°í•œë‹¤.
- Largest Rectangle in Histogramì²˜ëŸ¼,
  **pop ìˆœê°„ì— ì˜ë¯¸(êµ¬ê°„/ê²½ê³„)ê°€ í™•ì •ë˜ëŠ” êµ¬ì¡°**ë¥¼ ê·¸ëŒ€ë¡œ í™œìš©í•œë‹¤.

---

## ğŸ”— ê´€ë ¨ ë¬¸ì œ

- Largest Rectangle in Histogram
- Daily Temperatures
- Stock Span
- Maximal Rectangle
